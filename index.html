!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Meilech & Tzippy - The Big Day!</title>

  <!-- Google Fonts - Lora (for headings) and Lato (for body) -->
  <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS CDN - Provides utility classes for rapid styling -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>

  <!-- Main CSS Styling - This is where all custom styles and color variables are defined -->
  <style id="main-css">
    /* Color Variables (Moody Navy & Copper Chic) */
    :root {
      --color-base-light: #F2F4F7; /* Light grey-blue background for base sections */
      --color-base-dark: #EDF2F7; /* Slightly darker light base for details/chat/map sections */
      --color-primary-navy: #1E2C4F; /* Deep Navy Blue - main bold accent for text/buttons */
      --color-accent-copper: #B85C3A; /* Rich Copper/Burnt Orange - highlight for links/progress */
      --color-secondary-sage: #84A98C; /* Soft Sage Green - secondary balance/subtle accents */
      --color-text-dark: #1A202C; /* Very dark grey for main text */
      --color-text-medium: #4A5568; /* Medium grey for secondary text/paragraphs */
      --color-white: #FFFFFF; /* Pure white for backgrounds of cards, etc. */

      /* Dynamic Countdown Specific Colors - Will be set inline by JS, removed global fallbacks */
    }

    /* Global Base Styles */
    body {
      font-family: 'Lato', sans-serif;
      scroll-behavior: smooth;
      color: var(--color-text-dark);
      direction: ltr; /* Ensure LTR for the whole body */
      text-align: left; /* Default text alignment for LTR */
    }

    /* Custom Background Gradients for Sections */
    .bg-gradient-base {
      background: linear-gradient(to bottom right, var(--color-base-light), var(--color-base-dark));
    }
    .bg-gradient-details {
      background: linear-gradient(to bottom right, var(--color-base-dark), var(--color-base-light));
    }
    .bg-gradient-accent {
      background: linear-gradient(to bottom right, var(--color-primary-navy), #0A1C3E); /* Slightly darker navy for depth */
      color: var(--color-white); /* White text on dark background */
    }

    /* Font Classes */
    .font-heading { font-family: 'Lora', serif; }
    .font-body { font-family: 'Lato', sans-serif; }

    /* Custom Tailwind Overrides / New Classes */
    .text-primary-navy { color: var(--color-primary-navy); }
    .text-accent-copper { color: var(--color-accent-copper); }
    .text-secondary-sage { color: var(--color-secondary-sage); }
    .text-text-dark { color: var(--color-text-dark); }
    .text-text-medium { color: var(--color-text-medium); }
    .bg-primary-navy { background-color: var(--color-primary-navy); }
    .bg-accent-copper { background-color: var(--color-accent-copper); }
    .bg-secondary-sage { background-color: var(--color-secondary-sage); }
    .bg-card { background-color: var(--color-white); } /* For info cards, etc. */
    .text-white { color: var(--color-white); } /* Explicitly white text for dark backgrounds */


    /* Navigation Header */
    .header-nav {
      background-color: var(--color-white);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease-in-out; /* Smooth transition for background/shadow changes */
    }
    .header-nav.scrolled {
        background-color: rgba(255, 255, 255, 0.95); /* Slightly transparent white */
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        border-bottom-color: var(--color-base-dark);
    }
    .nav-link {
      position: relative;
      padding-bottom: 0.25rem; /* Space for underline */
      font-weight: 500; /* Slightly bolder */
      transition: color 0.3s ease-out; /* Smooth color transition */
    }
    .nav-link::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: 0;
      left: 50%; /* Center alignment based on LTR */
      right: auto; /* Unset right */
      background-color: var(--color-accent-copper);
      transition: width 0.3s ease-out, left 0.3s ease-out; /* Transition 'left' */
    }
    .nav-link:hover::after {
      width: 100%;
      left: 0; /* Extends from left */
      right: auto; /* Unset right */
    }
    .nav-link.active { /* For highlighting active link */
      color: var(--color-primary-navy);
      font-weight: 700;
    }
    .nav-link.active::after {
      width: 100%;
      left: 0;
      right: auto;
    }

    /* Hero Section Specifics */
    .hero-section {
      /* Using a subtle, elegant gradient for the background */
      background: linear-gradient(135deg, #F2F4F7 0%, #E0E7EB 50%, #F2F4F7 100%);
      position: relative;
      min-height: 100vh;
      padding-top: 8rem;
      padding-bottom: 8rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    /* Add a pseudo-element overlay for better text contrast if needed, or if an image were used */
    .hero-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.2); /* Very light white overlay */
      z-index: 0;
    }

    .hero-content {
      position: relative; /* Bring content above the pseudo-element overlay */
      z-index: 1; /* Ensure content is above the overlay */
      animation: fadeInScaleUp 1.2s ease-out forwards 0.5s;
      margin-top: auto;
      margin-bottom: auto;
    }
    @keyframes fadeInScaleUp {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    /* Enhanced Hero Names Styling */
    .hero-names {
      font-family: 'Lora', serif;
      font-size: 3.5rem; /* Base size, will scale up */
      letter-spacing: 0.05em; /* Add subtle letter spacing */
      text-shadow: 2px 2px 5px rgba(0,0,0,0.1); /* Soft shadow for depth */
      color: var(--color-primary-navy); /* Default color */
      margin-bottom: 0.5rem; /* Adjust spacing */
      line-height: 1.1;
      font-weight: 700;
    }
    @media (min-width: 768px) { /* md breakpoint */
      .hero-names { font-size: 5.5rem; } /* Larger on medium screens */
    }
    @media (min-width: 1024px) { /* lg breakpoint */
      .hero-names { font-size: 7rem; } /* Even larger on large screens */
    }

    /* Monogram styling */
    .monogram-svg {
      width: 4rem; /* Adjust size as needed */
      height: 4rem;
      margin-top: -1rem; /* Pull it closer to the names */
      margin-bottom: 1rem;
      transition: transform 0.3s ease-in-out;
      /* Ensure text direction is LTR within SVG if letters are English, or rely on x positioning */
      direction: ltr;
      text-align: left;
    }
    .monogram-svg:hover {
      transform: rotate(360deg) scale(1.1); /* Spins 360 degrees and scales up */
    }
    .monogram-initial {
      fill: var(--color-accent-copper); /* Use copper for the letters */
      font-family: 'Lora', serif; /* Ensure Lora for consistency with names */
    }
    .monogram-ampersand {
      fill: var(--color-primary-navy); /* Use navy for the ampersand */
      font-family: 'Lora', serif; /* Ensure Lora for consistency with names */
    }


    /* General Button Styles */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.75rem 2rem;
      border-radius: 9999px; /* Full rounded */
      font-weight: 600;
      text-align: center;
      white-space: nowrap;
      border: none;
      cursor: pointer;
      font-family: 'Lato', sans-serif;
      text-decoration: none; /* For anchor buttons */
    }
    .btn-primary {
      background-color: var(--color-primary-navy);
      color: var(--color-white);
    }
    .btn-primary:hover {
      background-color: var(--color-accent-copper);
      color: var(--color-white);
    }
    .btn-secondary {
      background-color: var(--color-secondary-sage);
      color: var(--color-white);
    }
    .btn-secondary:hover {
      background-color: var(--color-primary-navy);
      color: var(--color-white);
    }

    /* Countdown Card Styles */
    .countdown-card {
      background-color: var(--color-white);
      border: 2px solid transparent; /* Default transparent border, set by JS */
      transition: all 0.5s ease-in-out; /* Smooth transitions for dynamic changes */
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08); /* Default shadow, set by JS */
      cursor: pointer; /* Indicate clickability */
    }
    .countdown-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12); /* Slightly more prominent shadow on hover */
    }
    .countdown-value {
      color: var(--color-secondary-sage); /* Default color for numbers, set by JS */
      font-weight: bold;
      font-family: 'Lora', serif; /* Ensure Lora for numbers */
      transition: color 0.5s ease-in-out; /* Smooth color transition for numbers */
    }

    /* Ultra-close Countdown Flash Animation */
    @keyframes countdownFlash {
      0%, 100% {
        border-color: var(--color-accent-copper);
        box-shadow: 0 0 10px var(--color-accent-copper), 0 0 20px var(--color-accent-copper);
      }
      50% {
        border-color: var(--color-primary-navy);
        box-shadow: 0 0 15px var(--color-primary-navy), 0 0 25px var(--color-primary-navy);
      }
    }
    @keyframes textFlash {
        0%, 100% { color: var(--color-primary-navy); }
        50% { color: var(--color-accent-copper); }
    }

    /* Apply flashing to cards and their values when .countdown-flash is present */
    .countdown-card.countdown-flash {
      animation: countdownFlash 0.8s infinite alternate; /* Fast pulsing */
    }
    .countdown-card.countdown-flash .countdown-value {
        animation: textFlash 0.8s infinite alternate; /* Flash the numbers too */
    }


    /* Section Common Styles - Increased Padding */
    .section-padding {
      padding-top: 8rem; /* Increased from 5rem (py-32 equivalent) */
      padding-bottom: 8rem; /* Increased from 5rem (py-32 equivalent) */
      padding-left: 1.5rem; /* px-6 */
      padding-right: 1.5rem; /* px-6 */
      min-height: 100vh; /* Ensure sections take full viewport height */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center; /* Changed from left to center for general section text */
    }
    .section-title {
      font-family: 'Lora', serif;
      font-size: 2.5rem; /* md:text-5xl lg:text-6xl equivalent */
      line-height: 1.2;
      font-weight: 700;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.05); /* Subtle text shadow */
    }
    @media (min-width: 768px) { /* md breakpoint */
      .section-title { font-size: 3.5rem; }
    }
    @media (min-width: 1024px) { /* lg breakpoint */
      .section-title { font-size: 4rem; }
    }

    /* New style for the prominent total days display */
    .total-days-display {
      font-family: 'Lora', serif;
      font-size: 4rem; /* Even larger on desktop */
      font-weight: 700;
      color: var(--color-primary-navy);
      margin-bottom: 2rem;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.1);
    }
    @media (min-width: 768px) {
      .total-days-display {
        font-size: 6rem;
      }
    }


    /* Info Cards (Details, Map, Shabbos) */
    .info-card-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 2rem; /* gap-8 */
      max-width: 72rem; /* mx-auto */
      width: 100%;
    }
    @media (min-width: 768px) {
      .info-card-grid {
        grid-template-columns: repeat(2, 1fr); /* md:grid-cols-2 */
        gap: 3rem; /* md:gap-12 */
      }
    }

    .info-card {
      background-color: var(--color-white);
      border-radius: 1.5rem; /* rounded-2xl */
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); /* shadow-2xl */
      padding: 2.5rem; /* p-10 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center; /* Center text within card */
      transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    }
    .info-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }
    .icon-wrapper {
      margin-bottom: 1rem;
      background-color: var(--color-secondary-sage); /* Background for icon */
      border-radius: 50%;
      padding: 0.75rem;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .icon-large {
      width: 2.5rem; /* h-10 w-10 */
      height: 2.5rem;
      color: var(--color-white); /* Icon color */
    }

    /* Fun Facts Section */
    .fun-fact-grid {
      grid-template-columns: repeat(1, 1fr);
      gap: 1.5rem; /* gap-6 */
    }
    @media (min-width: 768px) {
      .fun-fact-grid {
        grid-template-columns: repeat(2, 1fr); /* md:grid-cols-2 */
      }
    }
    @media (min-width: 1024px) {
      .fun-fact-grid {
        grid-template-columns: repeat(3, 1fr); /* lg:grid-cols-3 */
      }
    }

    .fun-fact-card {
      background-color: var(--color-white);
      border-radius: 1.5rem; /* rounded-2xl */
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      padding: 2rem; /* p-8 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    }
    .fun-fact-card:hover {
      transform: translateY(-5px) rotate(1deg); /* Slight rotation on hover */
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }
    .fun-fact-title {
      color: var(--color-primary-navy);
      font-size: 1.75rem; /* text-2xl */
      font-weight: 700;
      margin-bottom: 0.75rem;
    }
    .fun-fact-text {
      color: var(--color-text-medium);
      font-size: 1.125rem; /* text-lg */
      line-height: 1.6;
    }

    /* FAQ Section */
    .faq-container {
      max-width: 48rem; /* mx-auto */
      width: 100%;
    }
    .faq-item {
      background-color: var(--color-white);
      border-radius: 1rem; /* rounded-lg */
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      overflow: hidden; /* Hide overflow when closed */
      margin-bottom: 1.5rem;
      border: 1px solid var(--color-base-dark); /* Subtle border */
      transition: all 0.3s ease;
    }
    .faq-item:hover {
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
    }
    .faq-question {
      background-color: var(--color-white);
      font-weight: 600;
      font-size: 1.25rem; /* text-xl */
      padding: 1rem 1.5rem; /* py-4 px-6 */
      color: var(--color-primary-navy);
      cursor: pointer;
      user-select: none; /* Prevent text selection on click */
      transition: background-color 0.3s ease;
      text-align: left; /* Ensure text is left-aligned in summary */
    }
    .faq-question:hover {
      background-color: var(--color-base-light);
    }
    .faq-item[open] .faq-question {
      background-color: var(--color-base-light);
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }
    .faq-arrow {
      color: var(--color-accent-copper);
    }
    .faq-answer {
      background-color: var(--color-base-light);
      padding: 0.5rem 1.5rem 1.5rem; /* pb-4 pt-2 px-6 */
      color: var(--color-text-medium);
      font-size: 1.125rem; /* text-lg */
      border-top: 1px solid var(--color-base-dark);
      text-align: left; /* Ensure text is left-aligned in answer */
    }

    /* Map Section Specifics */
    .map-embed {
      position: relative; /* Needed for absolute positioning of iframe */
      width: 100%;
      padding-bottom: 100%; /* This creates the square aspect ratio */
      height: 0; /* Important to collapse height and let padding define it */
      overflow: hidden; /* Ensure iframe doesn't overflow */
      border: 4px solid var(--color-primary-navy); /* Keep border */
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2); /* Keep shadow */
    }

    .map-embed iframe {
      position: absolute; /* Position iframe within the new padding-bottom container */
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    /* Blessings Section */
    .blessing-card { /* Renamed from heart-note for clarity and consistency */
      background-color: var(--color-secondary-sage);
      color: var(--color-white); /* Text color on sage background */
      font-weight: 600;
      padding: 2rem 1.25rem;
      border-radius: 1.5rem; /* slightly less rounded than before to be consistent with cards */
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
      /* animation: float 6s ease-in-out infinite; // Remove for controlled rotation */
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      min-height: 200px;
      font-size: 1.15rem;
      line-height: 1.6;
      transition: transform 0.3s ease, background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease; /* Added border-color, box-shadow */
    }
    .blessing-card:hover {
      transform: scale(1.04) rotate(0deg);
      background-color: var(--color-accent-copper);
    }
    /* New class for visual rotation */
    .blessing-card.highlighted {
        border-color: var(--color-accent-copper);
        box-shadow: 0 0 15px var(--color-accent-copper), 0 0 25px rgba(184, 92, 58, 0.4);
        transform: scale(1.02);
    }
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(-2deg); }
      50% { transform: translateY(-8px) rotate(0deg); }
    }
    @media (min-width: 768px) {
      .blessing-card { font-size: 1.25rem; padding: 2.5rem 1.5rem; min-height: 220px; }
    }
    @media (min-width: 1024px) {
      .blessing-card { font-size: 1.3rem; padding: 2.75rem 1.75rem; min-height: 240px; }
    }

    /* Chat & Questions Form */
    .input-field {
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem; /* rounded-lg */
      border: 1px solid var(--color-base-dark);
      background-color: var(--color-base-light);
      transition: all 0.3s ease;
      text-align: left; /* Align input text left */
    }
    .input-field:focus {
      outline: none;
      border-color: var(--color-accent-copper);
      box-shadow: 0 0 0 3px rgba(184, 92, 58, 0.2); /* Copper shadow */
    }

    /* Footer */
    footer {
      color: var(--color-text-medium);
      border-color: var(--color-base-dark);
    }
    footer a {
      color: var(--color-primary-navy);
    }
    footer a:hover {
      text-decoration: underline;
    }

    /* General Animations (can be used for hidden elements) */
    /* Fade-in for scroll animation */
    .fade-in-hidden {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.8s ease-out, transform 0.8s ease-out;
    }

    .fade-in-visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Styles for the secret message reveal */
    #secret-message-content {
      opacity: 0;
      transform: scaleY(0);
      transition: all 0.5s ease;
      transform-origin: top;
    }

    #secret-message-content.revealed {
      opacity: 1;
      transform: scaleY(1);
    }


    /* Utility classes for dynamic colors */
    .text-primary-navy { color: var(--color-primary-navy); }
    .text-accent-copper { color: var(--color-accent-copper); }
    .text-secondary-sage { color: var(--color-secondary-sage); }


    /* Removed LLM Blessing Generator Specific Styles */
    /* .llm-generator-card, .llm-loading, .llm-generated-output, .copy-btn styles are removed */


    .message-box {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--color-primary-navy);
        color: var(--color-white);
        padding: 15px 30px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        direction: ltr; /* Ensure message box text is LTR */
        text-align: left;
    }
    .message-box.show {
        opacity: 1;
        visibility: visible;
    }

    /* Guestbook & Blessing Post Specific Styles */
    /* The guestbook-message-card and related styles are now unused/removed */

    .loading-spinner {
        text-align: center;
        color: var(--color-primary-navy);
        font-weight: 600;
        margin-top: 2rem;
        direction: ltr;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 0.5rem;
    }
    .loading-spinner svg {
        animation: spin 1.5s linear infinite;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .current-user-id-display {
      font-size: 0.8rem;
      color: var(--color-text-medium);
      text-align: center;
      margin-top: 1rem;
      word-break: break-all;
      direction: ltr; /* Keep User ID LTR */
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
    }
    .modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background-color: var(--color-white);
      border-radius: 1.5rem;
      padding: 2rem;
      max-width: 90%;
      width: 500px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      transform: translateY(-20px);
      opacity: 0;
      transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
      position: relative;
    }
    .modal-overlay.show .modal-content {
      transform: translateY(0);
      opacity: 1;
    }

    .close-btn {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--color-text-medium);
      transition: color 0.2s ease;
    }
    .close-btn:hover {
      color: var(--color-primary-navy);
    }
  </style>

</head>
<body class="antialiased bg-gradient-base text-text-dark min-h-screen">

  <!-- Navigation Header - Sticky to remain visible while scrolling -->
  <header class="header-nav sticky top-0 z-50 transition-all duration-300">
    <nav class="container mx-auto flex justify-between items-center py-4 px-6">
      <!-- Site Title / Couple's Names (Moved monogram to hero) -->
      <a href="#hero-section" class="flex items-center space-x-2 text-primary-navy font-heading text-2xl font-bold tracking-tight hover:text-accent-copper transition-colors duration-300">
          <svg class="h-8 w-8 text-accent-copper" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="currentColor"/>
          </svg>
          <span>Meilech & Tzippy</span>
      </a>
      <!-- Navigation Links -->
      <ul class="flex space-x-6 nav-links text-text-medium font-body text-sm md:text-base">
        <li><a href="#hero-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Home</a></li>
        <li><a href="#countdown-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Countdown</a></li>
        <li><a href="#details-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Details</a></li>
        <li><a href="#fun-facts-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Fun Facts</a></li>
        <li><a href="#faq-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Q&A</a></li>
        <li><a href="#map-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Map</a></li>
        <li><a href="#shabbos-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Shabbos</a></li>
        <li><a href="#blessings-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Brachos</a></li>
        <li><a href="#chat-section" class="nav-link hover:text-accent-copper transition-colors duration-320">Chat</a></li>
      </ul>
    </nav>
  </header>

  <!-- Hero Section - The main welcoming and initial call to action -->
  <section id="hero-section" class="hero-section relative overflow-hidden flex flex-col justify-center items-center text-center px-6 py-20 md:py-32">
    <!-- Main content container with a "frosted glass" effect -->
    <div class="relative z-10 p-8 rounded-2xl bg-white bg-opacity-90 shadow-2xl backdrop-filter backdrop-blur-sm transform transition-all duration-700 ease-in-out scale-95 opacity-0 hero-content">
      <!-- Monogram -->
      <div class="mb-4">
        <svg class="monogram-svg mx-auto" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="70" font-family="Lora, serif" font-size="60" font-weight="bold" class="monogram-initial">M</text>
          <text x="45" y="70" font-family="Lora, serif" font-size="35" font-weight="bold" class="monogram-ampersand">&</text>
          <text x="65" y="70" font-family="Lora, serif" font-size="60" font-weight="bold" class="monogram-initial">T</text>
        </svg>
      </div>

      <!-- Main Heading for the couple's names -->
      <h1 class="hero-names text-primary-navy leading-tight mb-4 tracking-wide">
        Meilech & Tzippy
      </h1>
      <!-- Engaging tagline -->
      <p class="text-lg md:text-xl text-text-medium mb-4">
        Are Tying the Knot!
      </p>
      <!-- New descriptive text -->
      <p class="text-md md:text-lg text-text-medium mb-8 max-w-2xl mx-auto">
        With hearts full of joy and excitement, we invite you to join us as we embark on our greatest adventure yet:
        building a shared future together! Your presence would make our celebration truly complete.
      </p>

      <!-- Save the Date Button - Links to add event to Google Calendar -->
      <div class="mb-10 w-full max-w-sm mx-auto">
        <a id="save-date" href="#" target="_blank" rel="noopener noreferrer" class="btn btn-primary shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 inline-flex items-center space-x-2">
          <!-- Calendar SVG Icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <span>Save the Date!</span>
        </a>
      </div>

      <!-- Progress Bar - Now a button! -->
      <button id="progress-button" class="w-full max-w-xl mx-auto mt-6 bg-transparent border-none cursor-pointer p-0">
        <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden shadow-inner">
          <div id="progress-fill" class="h-full bg-accent-copper transition-all duration-1000 ease-out"></div>
        </div>
        <p class="mt-3 text-text-medium text-sm md:text-base font-body">
          Our hearts are <span id="percentDone" class="font-semibold">0%</span> full of love for the big day!
        </p>
      </button>

      <!-- New Hidden Interactive Element -->
      <div class="mt-12">
        <button id="secret-message-trigger" class="text-text-medium hover:text-accent-copper transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-accent-copper focus:ring-opacity-50 rounded-full px-4 py-2 text-sm italic">
          Discover a Little Secret... ❤️
        </button>
        <div id="secret-message-content" class="hidden mt-4 p-4 bg-secondary-sage text-white rounded-lg shadow-md max-w-sm mx-auto text-base text-center transform scale-y(0) opacity-0 transition-all duration-500 origin-top">
          <!-- Secret message will be injected here by JavaScript -->
        </div>
      </div>
    </div>

    <!-- Hidden confetti trigger spot (Easter egg) -->
    <div id="confetti-trigger-spot" class="absolute top-1/4 right-1/4 w-12 h-12 cursor-pointer opacity-0 z-30"></div>
  </section>

  <!-- Countdown Section - Dedicated page for detailed countdown -->
  <section id="countdown-section" class="section-padding bg-gradient-base text-center">
    <h2 class="section-title text-primary-navy mb-10">The Countdown Is On!</h2>

    <!-- Prominent "Total Days" display at the top of the countdown page -->
    <p class="total-days-display text-primary-navy mb-12">
      Only <span id="daysLeftCountdown" class="text-secondary-sage">0</span> Days to Go!
    </p>

    <!-- Detailed Countdown Timer Grid -->
    <div id="countdown-grid-wrapper" class="w-full max-w-5xl px-6 z-20">
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 md:gap-6 text-center">
        <!-- Each div is a countdown card with dynamic styling via 'countdown-card' and 'countdown-value' -->
        <div class="countdown-card p-4 md:p-6 rounded-xl shadow-md transition-all duration-500 ease-in-out hover:scale-105">
          <div class="text-text-medium text-sm md:text-base mb-1">Weeks</div>
          <div id="weeks" class="text-4xl md:text-5xl font-bold countdown-value">0</div>
        </div>
        <div class="countdown-card p-4 md:p-6 rounded-xl shadow-md transition-all duration-500 ease-in-out hover:scale-105">
          <div class="text-text-medium text-sm md:text-base mb-1">Days</div>
          <div id="days" class="text-4xl md:text-5xl font-bold countdown-value">0</div>
        </div>
        <div class="countdown-card p-4 md:p-6 rounded-xl shadow-md transition-all duration-500 ease-in-out hover:scale-105">
          <div class="text-text-medium text-sm md:text-base mb-1">Hours</div>
          <div id="hours" class="text-4xl md:text-5xl font-bold countdown-value">0</div>
        </div>
        <div class="countdown-card p-4 md:p-6 rounded-xl shadow-md transition-all duration-500 ease-in-out hover:scale-105">
          <div class="text-text-medium text-sm md:text-base mb-1">Minutes</div>
          <div id="minutes" class="text-4xl md:text-5xl font-bold countdown-value">0</div>
        </div>
        <div class="countdown-card p-4 md:p-6 rounded-xl shadow-md transition-all duration-500 ease-in-out hover:scale-105">
          <div class="text-text-medium text-sm md:text-base mb-1">Seconds</div>
          <div id="seconds" class="text-4xl md:text-5xl font-bold countdown-value">0</div>
        </div>
      </div>
      <!-- Hidden total days for confetti trigger (Easter egg) - kept here for easy access with related elements -->
      <p class="sr-only" id="totalDays">0</p>
    </div>
  </section>

  <!-- Wedding Details Section - Core information about the event -->
  <section id="details-section" class="section-padding bg-gradient-details text-center">
    <h2 class="section-title text-primary-navy mb-10">Wedding Day Details</h2>

    <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-8 md:gap-12 info-card-grid">

      <!-- Venue Card -->
      <div class="info-card fade-in-hidden">
        <div class="icon-wrapper">
          <!-- House/Building SVG Icon for Venue -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l9-9 9 9M5 10v9a2 2 0 002 2h10a2 2 0 002-2v-9"/>
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">The Grand Venue</h3>
        <p class="text-text-medium text-lg">
          Ateres Chaya Surah<br/>
          106 S Madison Ave<br/>
          Spring Valley, NY
        </p>
        <p class="text-text-medium text-md mt-2 italic">
          Where the magic happens, and the good vibes are contagious!
        </p>
      </div>

      <!-- Date Card -->
      <div class="info-card fade-in-hidden">
        <div class="icon-wrapper">
          <!-- Calendar SVG Icon -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">The Big Day</h3>
        <p class="text-text-medium text-lg">
          Monday, November 3, 2025<br/>
          י"ב חשון תשפ"ו
        </p>
        <p class="text-text-medium text-md mt-2 italic">
          Mark your calendars (seriously, it's gonna be epic!)
        </p>
      </div>

      <!-- Schedule Card - Spans two columns on larger screens -->
      <div class="info-card md:col-span-2 fade-in-hidden">
        <div class="icon-wrapper">
          <!-- Clock SVG Icon -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">The Flow of Simcha</h3>
        <p class="text-text-medium text-lg leading-relaxed">
          <strong>Kabulas Panim</strong> – 6:30 PM (Arrive early, good food starts punctually!)<br/>
          <strong>Chuppah</strong> – 7:30 PM (Prepare for happy tears and timeless moments!)<br/>
          <strong>Seudah</strong> – 8:30 PM (Let the feasting begin! You'll be glad you wore stretchy pants.)<br/>
          <strong>Dancing Begins</strong> – 10:00 PM (Bring your dancing shoes – and maybe some band-aids!)
        </p>
      </div>

      <!-- Vibe Card -->
      <div class="info-card fade-in-hidden">
        <div class="icon-wrapper">
          <!-- Happy Face SVG Icon for Vibe -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">The Vibe</h3>
        <p class="text-text-medium text-lg">
          Come ready to celebrate in joy and dignity. The evening will be full of music, warmth, and true simcha – expect some serious dancing!
        </p>
      </div>

      <!-- Transportation Card -->
      <div class="info-card fade-in-hidden">
        <div class="icon-wrapper">
          <!-- Car SVG Icon for Transportation -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 11H5a2 2 0 00-2 2v2a2 2 0 002 2h14a2 2 0 002-2v-2a2 2 0 00-2-2zM7 11V7a2 2 0 012-2h6a2 2 0 012 2v4M12 17v2m-2-2h4"/>
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">Getting There</h3>
        <p class="text-text-medium text-lg">
          Parking is available on-site. Consider carpooling – good simcha energy is always contagious!
        </p>
      </div>
    </div>
  </section>

  <!-- Fun Facts Section - New section with playful trivia -->
  <section id="fun-facts-section" class="section-padding bg-gradient-accent text-center">
    <h2 class="section-title text-white mb-10">Fun Facts & Funtastic Tidbits!</h2>
    <p class="text-lg text-white opacity-80 mb-12 max-w-2xl mx-auto">
      Because every epic love story deserves a few surprising footnotes and random trivia. Prepare to be amused!
    </p>

    <!-- Grid for fun fact cards -->
    <div class="max-w-5xl mx-auto grid md:grid-cols-2 lg:grid-cols-3 gap-6 fun-fact-grid">

      <div class="fun-fact-card fade-in-hidden">
        <h3 class="fun-fact-title font-heading text-primary-navy">Did You Know?</h3>
        <p class="fun-fact-text text-text-medium">
          Our wedding day, November 3rd, is also **National Sandwich Day!** We're taking a big bite out of forever.
        </p>
      </div>

      <div class="fun-fact-card fade-in-hidden">
        <h3 class="fun-fact-title font-heading text-primary-navy">Musical Interlude</h3>
        <p class="fun-fact-text text-text-medium">
          The number of times "Mazel Tov!" is expected to be shouted: approximately **1,000,000!** Start practicing your vocal chords.
        </p>
      </div>

      <div class="fun-fact-card fade-in-hidden">
        <h3 class="fun-fact-title font-heading text-primary-navy">Royal Status</h3>
        <p class="fun-fact-text text-text-medium">
          Jewish tradition says the Kallah is a queen and the Chassan is a king on their wedding day. Bow down, peasants! (Just kidding... mostly.)
        </p>
      </div>

      <div class="fun-fact-card fade-in-hidden">
        <h3 class="fun-fact-title font-heading text-primary-navy">Sweet Predictions</h3>
        <p class="fun-fact-text text-text-medium">
          Experts predict our wedding cake will magically disappear faster than a plate of kugel at a simcha.
        </p>
      </div>

      <div class="fun-fact-card fade-in-hidden">
        <h3 class="fun-fact-title font-heading text-primary-navy">Dancing Shoes Alert</h3>
        <p class="fun-fact-text text-text-medium">
          We've measured the dance floor: it's big enough for *everyone* to get down. Don't be shy!
        </p>
      </div>

      <div class="fun-fact-card fade-in-hidden">
        <h3 class="fun-fact-title font-heading text-primary-navy">Historic Day</h3>
        <p class="fun-fact-text text-text-medium">
          On November 3rd, 1957, the Soviet Union launched Sputnik 2, carrying the dog Laika into space. We're launching into marriage – slightly less space, more love!
        </p>
      </div>

    </div>
  </section>

  <!-- FAQ Section - New section for common questions with humorous answers -->
  <section id="faq-section" class="section-padding bg-gradient-base text-center">
    <h2 class="section-title text-primary-navy mb-10">Your Burning Questions (and Our Honest Answers)</h2>
    <p class="text-lg text-text-medium mb-12 max-w-2xl mx-auto">
      We know you've got 'em. Here are the answers to the questions you're *actually* thinking.
    </p>

    <!-- Accordion-style FAQ using <details> and <summary> tags -->
    <div class="max-w-3xl mx-auto text-left space-y-6 faq-container">

      <details class="faq-item group">
        <summary class="faq-question font-heading text-primary-navy cursor-pointer flex justify-between items-center py-4 px-6 rounded-lg transition-colors duration-300">
          What time should I arrive?
          <!-- Arrow icon for accordion toggle -->
          <svg class="faq-arrow h-6 w-6 transform transition-transform duration-300 group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </summary>
        <div class="faq-answer px-6 pb-4 pt-2 text-text-medium text-lg leading-relaxed">
          <p>We'd love to see you for Kabulas Panim at <strong>6:30 PM</strong>. Don't miss the Chuppah at 7:30 PM – it's the main event! Seriously, the good parts (and food!) start punctually.</p>
        </div>
      </details>

      <details class="faq-item group">
        <summary class="faq-question font-heading text-primary-navy cursor-pointer flex justify-between items-center py-4 px-6 rounded-lg transition-colors duration-300">
          What's the dress code?
          <svg class="faq-arrow h-6 w-6 transform transition-transform duration-300 group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </summary>
        <div class="faq-answer px-6 pb-4 pt-2 text-text-medium text-lg leading-relaxed">
          <p>Dress to impress, but also dress to dance! Formal, modest attire is appreciated. Think "Simcha Chic" – because comfort meets elegance when you're celebrating!</p>
        </div>
      </details>

      <details class="faq-item group">
        <summary class="faq-question font-heading text-primary-navy cursor-pointer flex justify-between items-center py-4 px-6 rounded-lg transition-colors duration-300">
          Can I bring my kids?
          <svg class="faq-arrow h-6 w-6 transform transition-transform duration-300 group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </summary>
        <div class="faq-answer px-6 pb-4 pt-2 text-text-medium text-lg leading-relaxed">
          <p>Absolutely! The more simcha, the merrier. Just remember to keep them away from the band's drum set and the dessert table (unless you brought extra for us!).</p>
        </div>
      </details>

      <details class="faq-item group">
        <summary class="faq-question font-heading text-primary-navy cursor-pointer flex justify-between items-center py-4 px-6 rounded-lg transition-colors duration-300">
          Is there food?
          <svg class="faq-arrow h-6 w-6 transform transition-transform duration-300 group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </summary>
        <div class="faq-answer px-6 pb-4 pt-2 text-text-medium text-lg leading-relaxed">
          <p>Is the sky blue?! We're having a wedding, so yes, there will be plenty of delicious food. Come hungry, leave happy!</p>
        </div>
      </details>

      <details class="faq-item group">
        <summary class="faq-question font-heading text-primary-navy cursor-pointer flex justify-between items-center py-4 px-6 rounded-lg transition-colors duration-300">
          Where can I park?
          <svg class="faq-arrow h-6 w-6 transform transition-transform duration-300 group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </summary>
        <div class="faq-answer px-6 pb-4 pt-2 text-text-medium text-lg leading-relaxed">
          <p>Ample parking is available on-site. For the full Monsey experience, allow an extra 15 minutes for unexpected traffic (especially on simcha days!).</p>
        </div>
      </details>

      <details class="faq-item group">
        <summary class="faq-question font-heading text-primary-navy cursor-pointer flex justify-between items-center py-4 px-6 rounded-lg transition-colors duration-300">
          Can I take photos?
          <svg class="faq-arrow h-6 w-6 transform transition-transform duration-300 group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </summary>
        <div class="faq-answer px-6 pb-4 pt-2 text-text-medium text-lg leading-relaxed">
          <p>We kindly request no flash photography during the Chuppah. Otherwise, snap away and share the simcha! Just don't block the professional photographers – they've got a job to do!</p>
        </div>
      </details>

      <!-- NEW: Flashmob FAQ -->
      <details class="faq-item group">
        <summary class="faq-question font-heading text-primary-navy cursor-pointer flex justify-between items-center py-4 px-6 rounded-lg transition-colors duration-300">
          Can I be part of the flashmob?
          <svg class="faq-arrow h-6 w-6 transform transition-transform duration-300 group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </summary>
        <div class="faq-answer px-6 pb-4 pt-2 text-text-medium text-lg leading-relaxed">
          <p>You're asking the real questions! Absolutely! If you've got moves (or even just enthusiasm!), we'd love to have you. Just reach out to <strong>Tzippy the kallah</strong>, and she'll share all the secret steps and make sure you're ready to bust a move! Get ready to dance the night away!</p>
        </div>
      </details>

      <details class="faq-item group">
        <summary class="faq-question font-heading text-primary-navy cursor-pointer flex justify-between items-center py-4 px-6 rounded-lg transition-colors duration-300">
          What if I have a question not listed here?
          <svg class="faq-arrow h-6 w-6 transform transition-transform duration-300 group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </summary>
        <div class="faq-answer px-6 pb-4 pt-2 text-text-medium text-lg leading-relaxed">
          <p>No worries! Scroll down to our "Chat" section – we're (virtually) here to help with almost anything. Or just find us at the dessert table on the night!</p>
        </div>
      </details>

    </div>
  </section>

  <!-- Map Section - Provides directions and key locations -->
  <section id="map-section" class="section-padding bg-gradient-details text-center">
    <h2 class="section-title text-primary-navy mb-10">Simcha Trail Map</h2>
    <p class="text-lg text-text-medium mb-4 max-w-2xl mx-auto">
      Lost? Don’t worry! We've pinned all the essential simcha stops just for you.
    </p>
    <p class="text-md text-text-medium mb-10 italic max-w-2xl mx-auto">
      Need help finding us? Just follow the music and smiles — we’ll be there!
    </p>
    <!-- Embedded Google Map -->
    <div class="max-w-6xl w-full mx-auto rounded-2xl overflow-hidden shadow-2xl mb-10 map-embed">
      <!-- IMPORTANT: Replace the 'src' with your actual Google Maps Embed API URL. This is a placeholder. -->
      <iframe
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d11977.830604163914!2d-74.02058300000001!3d41.1396113!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c2c19a9a9a9a9f%3A0x123456789abcdef0!2sAteres%20Chaya%20Surah!5e0!3m2!1sen!2suk!4v1689254321000!5m2=1sen%2suk"
        allowfullscreen=""
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade">
      </iframe>
    </div>
    <!-- Pinned locations and tip -->
    <div class="max-w-4xl mx-auto text-left info-card-grid grid md:grid-cols-2 gap-8 md:gap-12">
      <div class="info-card fade-in-hidden">
        <!-- Corrected HTML structure: icon-wrapper outside h3 -->
        <div class="icon-wrapper">
          <!-- List/Clipboard SVG Icon for "What's Pinned" -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M12 16h.01" />
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-3">What’s Pinned?</h3>
        <ul class="list-disc list-inside text-text-medium space-y-2">
          <li><strong>Wedding Venue:</strong> Ateres Chaya Surah, Spring Valley</li>
          <li><strong>Oifruf:</b> 3 Harvest Ct, Monsey</li>
          <li><strong>Bogleiten:</strong> 15 Sophia St, Monsey</li>
          <li><strong>Bovarfen:</strong> Belz Shul, 1 Harvest Ct</li>
          <li><strong>Shabbos Sheva Brachas:</strong> Bobov Shul, Jill Ln</li>
        </ul>
      </div>
      <div class="info-card fade-in-hidden">
        <!-- Corrected HTML structure: icon-wrapper outside h3 -->
        <div class="icon-wrapper">
          <!-- Lightbulb SVG Icon for "Top Tip" -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17H5.93a2 2 0 00-1.932 2.56L5 21h14a2 2 0 001.932-2.56L14.337 17H9.663zM12 7a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-3">Top Tip:</h3>
        <p class="text-text-medium">
          Leave a few minutes early. Monsey traffic likes to surprise you—especially on simcha days! Better safe than sorry (and missing the good appetizers!).
        </p>
      </div>
    </div>
  </section>

  <!-- Shabbos Events Section - Details for surrounding Shabbos gatherings -->
  <section id="shabbos-section" class="section-padding bg-gradient-accent text-center">
    <h2 class="section-title text-white mb-10">Shabbos Oifruf & Sheva Brachas</h2>
    <p class="text-lg text-white opacity-80 mb-12 max-w-2xl mx-auto">
      The simcha continues! Join us for these special Shabbos gatherings surrounding our wedding celebration.
    </p>
    <!-- Grid for Shabbos event cards -->
    <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-8 md:gap-12 info-card-grid">

      <!-- Oifruf Card -->
      <div class="info-card fade-in-hidden">
        <div class="icon-wrapper">
          <!-- Book/Torah scroll SVG Icon -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18s-3.332.477-4.5 1.253" />
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">Shabbos Oifruf Seudah</h3>
        <p class="text-text-medium text-lg">
          Beth Medrash D'Monsey Simcha Hall<br/>
          3 Harvest Ct.<br/>
          Monsey, NY 10952
        </p>
        <p class="text-text-medium text-md mt-2 italic">
          Come wish the chassan Mazel Tov before the big day! It's going to be packed with good vibes.
        </p>
      </div>

      <!-- Bogleiten Card -->
      <div class="info-card fade-in-hidden">
        <div class="icon-wrapper">
          <!-- People Walking SVG Icon -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292V15a4 4 0 010 5.292V21m0-16V3a1 1 0 00-1-1H4a1 1 0 00-1 1v2m0 13V9a1 1 0 011-1h7a1 1 0 011 1v7m0 0a1 1 0 001 1h7a1 1 0 001-1v-2m0 0a1 1 0 011-1h7a1 1 0 011 1v2" />
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">Bogleiten</h3>
        <p class="text-text-medium text-lg">
          Departing from:<br/>
          15 Sophia St.<br/>
          Monsey, NY 10952
        </p>
        <p class="text-text-medium text-md mt-2 italic">
          The grand send-off for the kallah – bring your singing voices and prepare for a joyful walk!
        </p>
      </div>

      <!-- Bovarfen Card -->
      <div class="info-card fade-in-hidden">
        <div class="icon-wrapper">
          <!-- Food/Candy SVG Icon for Bovarfen (representing treats/candy) -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8c1.657 0 3-4.5 3-9S13.657 0 12 0 9 4.5 9 9s1.343 9 3 9zM12 21a2 2 0 100-4 2 2 0 000 4zM12 17a2 2 0 100-4 2 2 0 000 4zM12 13a2 2 0 100-4 2 2 0 000 4z" />
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">Bovarfen</h3>
        <p class="text-text-medium text-lg">
          Belz Shul<br/>
          1 Harvest Ct.<br/>
          Monsey, NY 10952
        </p>
        <p class="text-text-medium text-md mt-2 italic">
          Prepare for some sweet treats and even sweeter moments! (And maybe a few friendly shoves.)
        </p>
      </div>

      <!-- Sheva Brachas Card -->
      <div class="info-card fade-in-hidden">
        <div class="icon-wrapper">
          <!-- Star/Sparkle SVG Icon for Sheva Brachas -->
          <svg class="icon-large text-accent-copper" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.324 1.114l1.519 4.674c.3.921-.755 1.688-1.539 1.114l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.574-1.839-.193-1.539-1.114l1.519-4.674a1 1 0 00-.324-1.114L2.093 10.09c-.783-.57-.381-1.81.588-1.81h4.915a1 1 0 00.95-.69l1.519-4.674z" />
          </svg>
        </div>
        <h3 class="font-heading text-2xl font-bold text-primary-navy mb-2">Shabbos Sheva Brachas</h3>
        <p class="text-text-medium text-lg">
          Bobov Shul<br/>
          20 Jill Ln.<br/>
          Monsey, NY 10952
        </p>
        <p class="text-text-medium text-md mt-2 italic">
          Continue the simcha with us on Shabbos! More good food and even better company.
        </p>
      </div>
    </div>
  </section>

  <!-- Blessings Section - Displays rotating blessings from family/friends -->
  <section id="blessings-section" class="section-padding bg-gradient-base text-center">
    <h2 class="section-title text-primary-navy mb-10">Messages of Simcha & Brachos!</h2>
    <p class="text-lg text-text-medium mb-12 max-w-2xl mx-auto">
      Share your heartfelt blessings for Meilech & Tzippy!
    </p>

    <!-- Blessing Wall - Content injected by JavaScript -->
    <div id="blessing-wall" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto"></div>

    <!-- The blessings-loading spinner is removed as pre-saved blessings are shown initially -->
    <!-- Call to Action button for sharing blessings -->
    <div class="mt-16">
      <button id="send-brucha-btn" class="btn btn-secondary shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
        Add Your Blessing! ✨
      </button>
    </div>

    <!-- Current User ID Display -->
    <p class="current-user-id-display">Your User ID: <span id="current-user-id">Loading...</span></p>

  </section>

  <!-- Chat & Questions Section - Form for guests to ask questions -->
  <section id="chat-section" class="section-padding bg-gradient-details text-center">
    <h2 class="section-title text-primary-navy mb-10">Got a Burning Question?</h2>
    <p class="text-lg text-text-medium mb-10 max-w-2xl mx-auto">
      Whether it's about directions, what time to show up, or where to find the best kugel — we’re (virtually) here to help!
    </p>

    <!-- Contact Form -->
    <div class="max-w-2xl mx-auto bg-card rounded-2xl shadow-2xl p-8 md:p-10">
      <!-- Form points to Formsubmit.co for easy backend handling -->
      <form id="contact-form" action="https://formsubmit.co/elimelechmoster@gmail.com" method="POST" class="space-y-6 text-left">
        <!-- Hidden inputs for Formsubmit.co functionality -->
        <input type="hidden" name="_autoresponse" value="Thank you for your message! We'll be in touch soon.">
        <input type="hidden" name="_template" value="table">
        <!-- IMPORTANT: Replace with your actual website URL for successful redirect after submission -->
        <input type="hidden" name="_next" value="https://yourwebsite.com/#thankyou-section">

        <!-- Honeypot field for basic bot spam protection (visually hidden) -->
        <div style="display: none;">
          <label for="hp_field">Leave this blank</label>
          <input type="text" id="hp_field" name="hp_field" autocomplete="off">
        </div>

        <!-- Name Input -->
        <div>
          <label for="chat-name" class="block text-lg text-primary-navy font-semibold mb-2">Your Name</label>
          <input type="text" id="chat-name" name="name" required class="input-field">
        </div>

        <!-- Email Input -->
        <div>
          <label for="chat-email" class="block text-lg text-primary-navy font-semibold mb-2">Your Email</label>
          <input type="email" id="chat-email" name="email" required class="input-field">
        </div>

        <!-- Message/Question Textarea -->
        <div>
          <label for="question" class="block text-lg text-primary-navy font-semibold mb-2">Your Question / Message</label>
          <textarea id="question" name="question" rows="5" required class="input-field"></textarea>
        </div>

        <!-- Submit Button -->
        <button type="submit" id="submit-contact-btn" class="btn btn-primary w-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
          Send Your Message!
        </button>
      </form>

      <!-- Humorous closing note -->
      <div class="mt-10 text-text-medium italic text-lg">
        <p>We’ll reply soon — or you can just come find us by the food table 😉</p>
      </div>
    </div>
  </section>

  <!-- Thank You Section - A heartfelt message to guests -->
  <section id="thankyou-section" class="section-padding bg-gradient-base text-center">
    <h2 class="section-title text-primary-navy mb-8">Thank You for Being Part of Our Simcha!</h2>
    <!-- Thank you message container -->
    <div class="max-w-4xl mx-auto text-lg text-text-medium space-y-6 bg-card rounded-2xl shadow-2xl p-8 md:p-10">
      <p>Dear family and friends, </p>
      <p>We’re so excited as we count down the days to our wedding, and we feel incredibly lucky to be surrounded by such immense love and support. Your warm wishes, thoughtful messages, and bubbling excitement mean more than we can possibly say.</p>
      <p>Thank you for joining us on this beautiful journey. Whether you’ll be dancing with us in person or celebrating from afar, your presence in our lives is a true blessing (a "bracha" for those who know the lingo!).</p>
      <p class="text-2xl md:text-3xl font-bold font-heading text-primary-navy mt-8">With all our love and excitement,</p>
      <p class="text-3xl md:text-4xl font-bold font-heading text-primary-navy">Meilech & Tzippy</p>
    </div>

    <!-- Button to navigate back to the chat section -->
    <div class="mt-12">
      <a href="#chat-section" class="btn btn-secondary shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
        Still Have a Question? Chat With Us!
      </a>
    </div>
  </section>

  <!-- Footer - Copyright and contact information -->
  <footer class="text-center py-8 text-text-medium text-sm border-t border-gray-200">
    <p class="mb-2">&copy; 2025 Meilech & Tzippy. Built with love, laughter, and a touch of magic.</p>
    <p>Questions? Reach out to us at <a href="mailto:elimelechmoster@gmail.com" class="text-primary-navy hover:underline">elimelechmoster@gmail.com</a></p>
  </footer>

  <!-- Message box for copy confirmation -->
  <div id="message-box" class="message-box"></div>

  <!-- Blessing Submission Modal -->
  <div id="blessing-modal-overlay" class="modal-overlay">
    <div class="modal-content">
      <button class="close-btn" id="close-blessing-modal">&times;</button>
      <h3 class="font-heading text-2xl font-bold text-primary-navy mb-4 text-center">Add Your Blessing! ✨</h3>
      <p class="text-text-medium mb-6 text-center">
          Share your well wishes for Meilech & Tzippy directly on our blessings wall!
      </p>
      <form id="blessing-form" class="space-y-4 text-left">
        <div>
          <label for="blessing-name" class="block text-lg text-primary-navy font-semibold mb-2">Your Name</label>
          <input type="text" id="blessing-name" required class="input-field" placeholder="Your Name">
        </div>
        <div>
          <label for="blessing-text" class="block text-lg text-primary-navy font-semibold mb-2">Your Blessing</label>
          <textarea id="blessing-text" rows="4" required class="input-field" placeholder="Write your heartfelt blessing here..."></textarea>
        </div>
        <button type="submit" id="submit-blessing-btn" class="btn btn-primary w-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
          Post Your Blessing!
        </button>
      </form>
    </div>
  </div>


  <!-- Confetti.js CDN - Required for confetti effects -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, onSnapshot, query, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // --- Main JavaScript (Encapsulated) ---
    (function(){
      // --- Configuration & Elements ---
      // Dates
      const ENGAGEMENT_TS = new Date("2025-01-29T00:00:00").getTime();
      const WEDDING_TS    = new Date("2025-11-03T18:30:00").getTime(); // Nov 3, 2025 at 6:30 PM

      // DOM Elements
      const daysLeftCountdownEl = document.getElementById("daysLeftCountdown"); // Prominent display on the countdown page
      const totalDaysHiddenEl   = document.getElementById("totalDays"); // Hidden for confetti trigger from Hero
      const weeksEl             = document.getElementById("weeks");
      const daysEl              = document.getElementById("days");
      const hoursEl             = document.getElementById("hours");
      const minsEl              = document.getElementById("minutes");
      const secsEl              = document.getElementById("seconds");
      const progressFillEl      = document.getElementById("progress-fill");
      const percentDoneEl       = document.getElementById("percentDone");
      const saveDateBtn         = document.getElementById("save-date");
      const blessingWall        = document.getElementById("blessing-wall");
      const sendBruchaBtn       = document.getElementById("send-brucha-btn");
      const heroContent         = document.querySelector(".hero-content");
      const confettiTriggerSpot = document.getElementById("confetti-trigger-spot");
      const navHeader           = document.querySelector(".header-nav");
      const progressButton      = document.getElementById("progress-button"); // Progress bar button
      const messageBox          = document.getElementById('message-box');

      // Elements for scroll-fade-in
      const elementsToFadeIn = document.querySelectorAll('.info-card, .fun-fact-card');

      // Guestbook Elements (removed from HTML, but keep vars for cleanup)
      const guestbookForm          = null; // document.getElementById('guestbook-form');
      const guestbookNameInput     = null; // document.getElementById('guestbook-name');
      const guestbookMessageInput  = null; // document.getElementById('guestbook-message');
      const guestbookMessagesDisplay = null; // document.getElementById('guestbook-messages-display');
      const guestbookLoading       = document.getElementById('guestbook-loading'); // Still exists for now, removed later

      // Contact Form Elements
      const contactForm            = document.getElementById('contact-form');
      const submitContactBtn       = document.getElementById('submit-contact-btn');

      // New hidden message elements
      const secretMessageTrigger = document.getElementById('secret-message-trigger');
      const secretMessageContent = document.getElementById('secret-message-content');
      let secretMessageTimeout; // To store the timeout ID for auto-hiding
      let currentSecretMessageIndex = 0; // To track which secret message to show

      // Array of secret messages (UPDATED)
      const secretMessages = [
        "A hidden path leads to the heart of every story.",
        "The universe whispers its secrets to those who truly listen.",
        "Every end is just a new beginning, waiting to unfold.",
        "Love is the only language that transcends all barriers.",
        "The greatest adventures often begin with a single, silent promise.",
        "In every moment, there's a universe of possibilities waiting to be discovered."
      ];

      // Get references to the countdown card elements for confetti
      const weeksCard   = weeks.parentElement;
      const daysCard    = days.parentElement;
      const hoursCard   = hours.parentElement;
      const minutesCard = minutes.parentElement;
      const secondsCard = seconds.parentElement;

      // Blessing Modal Elements
      const blessingModalOverlay = document.getElementById('blessing-modal-overlay');
      const closeBlessingModalBtn = document.getElementById('close-blessing-modal');
      const blessingForm = document.getElementById('blessing-form');
      const blessingNameInput = document.getElementById('blessing-name');
      const blessingTextInput = document.getElementById('blessing-text');
      // blessingsLoading is removed from HTML

      // Firebase variables (initialized later)
      let app, db, auth, userId;
      let isAuthReady = false;

      // New: Pre-saved blessings data
      const initialBlessingsData = [
        { name: "A Loving Friend", text: "May your journey together be filled with boundless joy and unending harmony! Mazel Tov!" },
        { name: "Family Member", text: "Wishing you a lifetime of happiness, health, and true nachas. We love you both!" },
        { name: "Well-Wisher", text: "May your home always be a beacon of light, warmth, and beautiful blessings." },
        { name: "Simcha Seeker", text: "Chassan Kallah Mazel Tov! May your union inspire all around you." },
        { name: "Supporter", text: "So much simcha! May you build an everlasting edifice of love and Torah." },
        { name: "Future Guest", text: "Wishing you mazel and bracha for all your days. Ad-Meya Ve-Esrim!" },
        { name: "Good Friend", text: "May your lives together be even sweeter than the wedding cake. Congrats!" },
        { name: "Community Member", text: "May you be zoche to build a beautiful family together, full of chesed and simcha." },
        { name: "Proud Relative", text: "Our hearts are overflowing with joy for you both. May you always share such love!" },
        { name: "Anon Friend", text: "May you be blessed with everything good, physically and spiritually. Mazel Tov!" }
      ];
      let initialBlessingsInterval = null; // To store the interval ID for initial blessings rotation
      let currentHighlightedBlessingIndex = 0;


      // --- Utility Functions ---

      /**
       * Shows a temporary message box.
       * @param {string} message - The message to display.
       * @param {number} duration - How long to display the message in milliseconds.
       */
      function showMessageBox(message, duration = 3000) {
          messageBox.textContent = message;
          messageBox.classList.add('show');
          setTimeout(() => {
              messageBox.classList.remove('show');
          }, duration);
      }

      /**
       * Shows a modal.
       * @param {HTMLElement} modalElement - The modal overlay element to show.
       */
      function showModal(modalElement) {
          modalElement.classList.add('show');
      }

      /**
       * Hides a modal.
       * @param {HTMLElement} modalElement - The modal overlay element to hide.
       */
      function hideModal(modalElement) {
          modalElement.classList.remove('show');
      }

      /**
       * Triggers a confetti animation.
       * @param {Object} [options] - Optional parameters for confetti.
       * @param {number} [options.x] - Normalized x-coordinate (0-1).
       * @param {number} [options.y] - Normalized y-coordinate (0-1).
       * @param {Array<string>} [options.colors] - Array of hex color codes.
       */
      function triggerConfetti(options = {}) {
        confetti({
          particleCount: options.particleCount || 100,
          spread: options.spread || 70,
          origin: options.origin || { y: 0.6 },
          colors: options.colors || ['#B85C3A', '#1E2C4F', '#84A98C', '#F2F4F7']
        });
      }

      // --- Countdown & Progress Logic ---

      /**
       * Applies dynamic styles to individual countdown cards based on their own value.
       * Also applies a global flashing effect when very close to 0 seconds.
       * @param {number} weeksVal - Current weeks value.
       * @param {number} daysVal - Current days (remainder) value.
       * @param {number} hoursVal - Current hours value.
       * @param {number} minutesVal - Current minutes value.
       * @param {number} secondsVal - Current seconds value.
       * @param {number} totalDiffMs - Total milliseconds remaining until wedding.
       */
      function applyIndividualCountdownStyles(weeksVal, daysVal, hoursVal, minutesVal, secondsVal, totalDiffMs) {
        const countdownElements = [
          { card: weeksCard, value: weeksVal },
          { card: daysCard, value: daysVal },
          { card: hoursCard, value: hoursVal },
          { card: minutesCard, value: minutesVal },
          { card: secondsCard, value: secondsVal }
        ];

        // Define color and shadow properties for different intensity levels
        const intensityColors = {
            default: { color: 'var(--color-secondary-sage)', border: 'transparent', shadow: '0 6px 20px rgba(0, 0, 0, 0.08)' },
            lessIntense: { color: 'var(--color-accent-copper)', border: 'var(--color-accent-copper)', shadow: '0 0 8px rgba(0,0,0,0.1), 0 0 10px var(--color-accent-copper)' }, // For < 20
            mediumIntense: { color: 'var(--color-primary-navy)', border: 'var(--color-primary-navy)', shadow: '0 0 10px rgba(0,0,0,0.15), 0 0 15px var(--color-primary-navy)' }, // For < 10
            mostIntense: { color: 'var(--color-accent-copper)', border: 'var(--color-primary-navy)', shadow: '0 0 15px rgba(0,0,0,0.2), 0 0 20px var(--color-primary-navy)' } // For < 5
        };

        // Apply styles based on individual value thresholds
        countdownElements.forEach(item => {
          const card = item.card;
          const val = item.value; // The current number in the box
          const valueEl = card.querySelector('.countdown-value');

          // Reset styles first to ensure changes are applied correctly
          card.style.borderColor = '';
          card.style.boxShadow = '';
          valueEl.style.color = '';
          card.classList.remove('countdown-flash'); // Remove flash for individual logic first

          let currentStyle = intensityColors.default;

          if (val <= 4 && val >= 0) { // 0 to 4 (most intense before flashing)
            currentStyle = intensityColors.mostIntense;
          } else if (val <= 9 && val >= 5) { // 5 to 9
            currentStyle = intensityColors.mediumIntense;
          } else if (val <= 19 && val >= 10) { // 10 to 19
            currentStyle = intensityColors.lessIntense;
          }
          // If none of the above, it remains default (sage)

          // Apply individual styles
          card.style.setProperty('border-color', currentStyle.border);
          card.style.setProperty('box-shadow', currentStyle.shadow);
          valueEl.style.setProperty('color', currentStyle.color);
        });

        // Global flashing for less than 20 seconds total, overriding individual animations if active
        const twentySecondsInMs = 20 * 1000;
        if (totalDiffMs > 0 && totalDiffMs < twentySecondsInMs) {
          countdownElements.forEach(item => {
            item.card.classList.add('countdown-flash');
            // The CSS animation `textFlash` will handle the color for `.countdown-value` when `.countdown-flash` is present
          });
        }
      }

      /**
       * Calculates and updates all countdown elements and the progress bar.
       */
      function updateAll() {
        const now    = Date.now();
        const diff   = WEDDING_TS - now; // Time remaining in milliseconds
        const dTotal = Math.max(0, Math.floor(diff / (1000*60*60*24))); // Total full days remaining

        const w      = Math.floor(dTotal / 7); // Weeks
        const dRem   = dTotal % 7; // Remaining days in current week
        const h      = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
        const m      = Math.floor((diff % (1000*60*60)) / (1000*60));
        const s      = Math.floor((diff % (1000*60)) / 1000);

        // Update prominent total days on countdown page
        if (daysLeftCountdownEl) {
          daysLeftCountdownEl.innerText = dTotal;
        }

        // Update detailed countdown numbers
        weeksEl.innerText    = w;
        daysEl.innerText     = dRem;
        hoursEl.innerText    = h;
        minsEl.innerText     = m;
        secsEl.innerText     = s;

        // Update hidden total days for confetti trigger (still uses totalEl)
        totalDaysHiddenEl.innerText = dTotal;

        // Progress % from engagement→wedding
        const span   = WEDDING_TS - ENGAGEMENT_TS;
        const done   = now - ENGAGEMENT_TS;
        const pct    = Math.min(100, Math.max(0, Math.round((done/span)*100)));
        progressFillEl.style.width = pct + "%";
        percentDoneEl.innerText    = pct + "%";

        // Apply dynamic styles based on individual and total remaining time
        applyIndividualCountdownStyles(w, dRem, h, m, s, diff);

        // If wedding passed, stop interval and show message
        if (diff <= 0) {
          clearInterval(countdownInterval);
          if (daysLeftCountdownEl) daysLeftCountdownEl.innerText = "0";
          totalDaysHiddenEl.innerText = "0";
          weeksEl.innerText = "0";
          daysEl.innerText = "0";
          hoursEl.innerText = "0";
          minsEl.innerText = "0";
          secsEl.innerText = "0";
          percentDoneEl.innerText = "100%";
          progressFillEl.style.width = "100%";
          heroContent.querySelector('p:first-of-type').textContent = "They tied the knot! 🎉";
          saveDateBtn.style.display = "none"; // Hide save date button after wedding
          triggerConfetti(); // Final burst of confetti
        }
      }

      /**
       * Sets up the Google Calendar "Save the Date" link.
       */
      function setupSaveDate() {
        const title    = encodeURIComponent("Meilech & Tzippy’s Wedding!");
        const details = encodeURIComponent(
          "Join us for the chuppah, seudah, dancing & simcha!\nVenue: Ateres Chaya Surah, 106 S Madison Ave, Spring Valley, NY"
        );
        const loc      = encodeURIComponent("Ateres Chaya Surah, 106 S Madison Ave, Spring Valley, NY");
        // Dates format:YYYYMMDDTHHMMSSZ/YYYYMMDDTHHMMSSZ
        const start    = new Date(WEDDING_TS).toISOString().replace(/-|:|\.\d+/g,"");
        const end      = new Date(WEDDING_TS + 4*60*60*1000).toISOString().replace(/-|:|\.\d+/g,""); // 4 hours after wedding start

        saveDateBtn.href  =
          `https://calendar.google.com/calendar/render?action=TEMPLATE` +
          `&text=${title}` +
          `&dates=${start}/${end}` +
          `&details=${details}` +
          `&location=${loc}` +
          `&sf=true&output=xml`;
      }

      // --- Blessings Wall Logic ---

      /**
       * Creates and appends a blessing card to the wall.
       * @param {object} blessing - The blessing object {name, text, timestamp}.
       */
      function createBlessingCard(blessing, isInitial = false) {
        const div = document.createElement('div');
        div.className = 'blessing-card fade-in-hidden relative overflow-hidden group';
        // Only show timestamp for real blessings, not initial ones
        const date = blessing.timestamp && !isInitial ? new Date(blessing.timestamp.seconds * 1000).toLocaleString('en-US') : '';
        div.innerHTML = `
          <p class="relative z-10 text-center font-body text-lg">${blessing.text}</p>
          <p class="relative z-10 text-center text-sm font-semibold mt-4 text-primary-navy group-hover:text-white transition-colors duration-300">- ${blessing.name} ${date ? `<span class="text-xs">(${date})</span>` : ''}</p>
          <div class="absolute inset-0 bg-accent-copper opacity-0 group-hover:opacity-100 transition-opacity duration-300 transform scale-x-0 group-hover:scale-x-100 origin-left rounded-2xl"></div>
        `;
        blessingWall.prepend(div); // Add new blessings to the top
        // Trigger fade-in animation
        setTimeout(() => {
          div.classList.add('fade-in-visible');
          div.classList.remove('fade-in-hidden');
        }, 100);
      }

      /**
       * Displays the pre-saved blessings and starts their rotation.
       */
      function displayInitialBlessings() {
          blessingWall.innerHTML = ''; // Clear any existing content
          initialBlessingsData.forEach(blessing => createBlessingCard(blessing, true)); // Pass true for isInitial

          // Start rotation only if not already running
          if (!initialBlessingsInterval) {
              initialBlessingsInterval = setInterval(() => {
                  const cards = blessingWall.querySelectorAll('.blessing-card');
                  if (cards.length === 0) {
                      clearInterval(initialBlessingsInterval);
                      initialBlessingsInterval = null;
                      return;
                  }

                  // Remove highlight from previous card
                  if (cards[currentHighlightedBlessingIndex]) {
                      cards[currentHighlightedBlessingIndex].classList.remove('highlighted');
                  }

                  // Move to next card, loop back if at end
                  currentHighlightedBlessingIndex = (currentHighlightedBlessingIndex + 1) % cards.length;

                  // Add highlight to current card
                  if (cards[currentHighlightedBlessingIndex]) {
                      cards[currentHighlightedBlessingIndex].classList.add('highlighted');
                  }
              }, 3000); // Change every 3 seconds
          }
      }

      /**
       * Fetches and listens for real-time updates to blessings.
       */
      function setupBlessingsListener() {
        if (!db || !isAuthReady) {
            console.warn("Firestore not initialized or auth not ready for blessings listener.");
            displayInitialBlessings(); // Always display initial if not ready
            return;
        }

        // Display initial blessings while waiting for Firebase data
        displayInitialBlessings(); // Show placeholders immediately

        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const q = query(collection(db, `/artifacts/${appId}/public/data/wedding_blessings`));

        onSnapshot(q, (snapshot) => {
            const blessings = [];
            snapshot.forEach(doc => {
                blessings.push(doc.data());
            });

            // If real data exists, stop initial blessing rotation and clear wall
            if (blessings.length > 0) {
                if (initialBlessingsInterval) {
                    clearInterval(initialBlessingsInterval);
                    initialBlessingsInterval = null;
                }
                blessingWall.innerHTML = ''; // Clear initial blessings
                blessings.sort((a, b) => {
                    const tsA = a.timestamp ? a.timestamp.seconds : 0;
                    const tsB = b.timestamp ? b.timestamp.seconds : 0;
                    return tsB - tsA; // Newest first
                });
                blessings.forEach(blessing => createBlessingCard(blessing));

                blessingWall.querySelectorAll('.fade-in-hidden').forEach(el => {
                    el.classList.add('fade-in-visible');
                    el.classList.remove('fade-in-hidden');
                });
            } else {
                // If no real blessings, ensure initial blessings are displayed and rotating
                displayInitialBlessings();
            }
        }, (error) => {
            console.error("Error listening to blessings: ", error);
            // Fallback to initial blessings if there's an error after trying to load real data
            displayInitialBlessings();
        });
      }

      /**
       * Handles blessing form submission.
       * @param {Event} event - The form submission event.
       */
      async function handleBlessingSubmit(event) {
          event.preventDefault();

          if (!db || !isAuthReady) {
              showMessageBox("Authentication not ready. Please try again in a moment.", 3000);
              return;
          }

          const name = blessingNameInput.value.trim();
          const text = blessingTextInput.value.trim();

          if (!name || !text) {
              showMessageBox("Please fill in both your name and blessing!", 2000);
              return;
          }

          try {
              const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
              await addDoc(collection(db, `/artifacts/${appId}/public/data/wedding_blessings`), {
                  name: name,
                  text: text,
                  timestamp: serverTimestamp(), // Firestore automatically adds a server-side timestamp
                  userId: userId // Store the user ID for debugging/moderation
              });
              showMessageBox("Your blessing was added to the wall! Thank you! 😊");
              blessingNameInput.value = '';
              blessingTextInput.value = '';
              hideModal(blessingModalOverlay); // Hide the modal after submission
          } catch (e) {
              console.error("Error adding blessing: ", e);
              showMessageBox("Failed to send blessing. Please try again.", 3000);
          }
      }

      // --- Guestbook Logic (Removed) ---
      // All guestbook functions like displayGuestbookMessage, setupGuestbookListener, handleGuestbookSubmit are removed.


      /**
       * Handles contact form submission.
       * Added a local message box for immediate feedback, before formsubmit.co redirects.
       * @param {Event} event - The form submission event.
       */
      function handleContactSubmit(event) {
          // The form will still submit and redirect via Formsubmit.co action
          // This message will appear briefly before the redirect.
          showMessageBox("Message sent! We'll be in touch faster than you can say 'Mazel Tov!' 🥳");
          // Optionally, you could add event.preventDefault() here and handle the submission
          // via Fetch API if you don't want a redirect, but Formsubmit.co requires it by default.
      }


      // --- Firebase Initialization and Auth ---
      async function initializeFirebase() {
          try {
              const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
              app = initializeApp(firebaseConfig);
              db = getFirestore(app);
              auth = getAuth(app);

              currentUserIdDisplay.textContent = 'Authenticating...';

              // Listen for auth state changes
              onAuthStateChanged(auth, async (user) => {
                  if (user) {
                      // User is signed in.
                      userId = user.uid;
                      currentUserIdDisplay.textContent = userId;
                      isAuthReady = true;
                      // Removed guestbook listener call here
                      setupBlessingsListener(); // Start listening for blessings messages once authenticated
                  } else {
                      // User is signed out, try to sign in anonymously
                      try {
                          if (typeof __initial_auth_token !== 'undefined') {
                              await signInWithCustomToken(auth, __initial_auth_token);
                          } else {
                              await signInAnonymously(auth);
                          }
                          // This will trigger onAuthStateChanged again
                      } catch (error) {
                          console.error("Firebase Auth Error:", error);
                          currentUserIdDisplay.textContent = "Auth Error!";
                          showMessageBox("Failed to authenticate. Features requiring sign-in may not function.", 5000);
                          isAuthReady = false;
                      }
                  }
              });
          } catch (error) {
              console.error("Firebase initialization failed:", error);
              showMessageBox("Failed to load Firebase. Some features may not function.", 5000);
              isAuthReady = false;
          }
      }


      // --- Intersection Observer for Scroll Fade-in ---
      const observerOptions = {
        root: null, // viewport
        rootMargin: '0px',
        threshold: 0.1 // Trigger when 10% of the item is visible
      };

      const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('fade-in-visible');
            entry.target.classList.remove('fade-in-hidden');
            // No unobserve here for guestbook messages, as new ones can appear and need animation
            // For other elements, like info-cards, you can unobserve after animation
            if (entry.target.classList.contains('info-card') || entry.target.classList.contains('fun-fact-card') || entry.target.classList.contains('blessing-card')) {
                // If it's a blessing card and part of initial display, keep observing for highlight effect
                if (!entry.target.classList.contains('highlighted')) { // Only unobserve if it's not currently highlighted (to allow re-highlighting)
                   // The highlight logic will manage which cards are observed/unobserved.
                   // For a persistent visual effect (like rotation), we shouldn't unobserve immediately.
                   // So, removing this unobserve for blessing-card to allow the rotation logic to function.
                }
            }
          }
        });
      }, observerOptions);


      // --- Event Listeners ---
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize hero content fade-in
        heroContent.classList.add('opacity-100', 'scale-100');

        // Set up countdown and start updating every second
        setupSaveDate();
        updateAll();
        const countdownInterval = setInterval(updateAll, 1000);

        // Confetti trigger for total days remaining (hidden element)
        totalDaysHiddenEl.addEventListener('click', triggerConfetti);

        // Confetti trigger for the couple's names in the hero section
        heroContent.querySelector('h1').addEventListener('click', triggerConfetti);

        // Hidden confetti trigger spot
        confettiTriggerSpot.addEventListener('click', triggerConfetti);

        // Add click listeners to each countdown card for confetti
        function triggerLocalizedConfetti(targetElement, colors) {
            const rect = targetElement.getBoundingClientRect();
            const originX = (rect.left + rect.right) / 2 / window.innerWidth;
            const originY = (rect.top + rect.bottom) / 2 / window.innerHeight;

            confetti({
                particleCount: 50,
                spread: 90,
                origin: { x: originX, y: originY },
                colors: colors || ['#B85C3A', '#1E2C4F', '#84A98C']
            });
        }

        weeksCard.addEventListener('click', () => triggerLocalizedConfetti(weeksCard, ['#84A98C', '#F2F4F7'])); // Sage, light
        daysCard.addEventListener('click', () => triggerLocalizedConfetti(daysCard, ['#B85C3A', '#1E2C4F']));   // Copper, navy
        hoursCard.addEventListener('click', () => triggerLocalizedConfetti(hoursCard, ['#1E2C4F', '#B85C3A']));  // Navy, copper
        minutesCard.addEventListener('click', () => triggerLocalizedConfetti(minutesCard, ['#84A98C', '#1E2C4F']));// Sage, navy
        secondsCard.addEventListener('click', () => triggerLocalizedConfetti(secondsCard, ['#B85C3A', '#F2F4F7']));// Copper, light

        // Event listener for the progress bar button
        progressButton.addEventListener('click', () => {
          const rect = progressButton.getBoundingClientRect();
          triggerConfetti({
            origin: {
              x: (rect.left + rect.right) / 2 / window.innerWidth,
              y: (rect.top + rect.bottom) / 2 / window.innerHeight
            },
            particleCount: 75,
            spread: 60,
            colors: ['#B85C3A', '#1E2C4F', '#84A98C']
          });
          showMessageBox("Hearts are full of love! 🎉", 2500);
        });

        // New: Event listener for Save the Date button
        saveDateBtn.addEventListener('click', () => {
            showMessageBox("Can't wait to celebrate with you! Thanks for marking your calendar! ✨", 3000);
        });

        // Blessing Modal Event Listeners
        sendBruchaBtn.addEventListener('click', () => showModal(blessingModalOverlay));
        closeBlessingModalBtn.addEventListener('click', () => hideModal(blessingModalOverlay));
        blessingModalOverlay.addEventListener('click', (event) => {
            // Close modal if user clicks outside the content (on the overlay itself)
            if (event.target === blessingModalOverlay) {
                hideModal(blessingModalOverlay);
            }
        });
        blessingForm.addEventListener('submit', handleBlessingSubmit);

        // Sticky nav class on scroll
        window.addEventListener('scroll', () => {
          if (window.scrollY > 50) { // After scrolling 50px
            navHeader.classList.add('scrolled');
          } else {
            navHeader.classList.remove('scrolled');
          }
        });

        // Removed Guestbook Event Listener: guestbookForm.addEventListener('submit', handleGuestbookSubmit);

        // New: Contact Form Event Listener
        contactForm.addEventListener('submit', handleContactSubmit);

        // Secret message trigger
        secretMessageTrigger.addEventListener('click', () => {
            // Clear any existing timeout to prevent previous message from disappearing
            if (secretMessageTimeout) {
                clearTimeout(secretMessageTimeout);
            }

            // Update content with the next message
            secretMessageContent.textContent = secretMessages[currentSecretMessageIndex];
            currentSecretMessageIndex = (currentSecretMessageIndex + 1) % secretMessages.length; // Cycle through messages

            // Reveal the message
            secretMessageContent.classList.remove('hidden');
            // Force reflow for transition to work if it was hidden
            void secretMessageContent.offsetWidth;
            secretMessageContent.classList.add('revealed');

            // Set timeout to hide message after 10 seconds
            secretMessageTimeout = setTimeout(() => {
                secretMessageContent.classList.remove('revealed');
                setTimeout(() => {
                    secretMessageContent.classList.add('hidden');
                }, 500); // Matches transition duration for smooth fade-out
            }, 10000); // 10 seconds
        });


        // Observe elements for scroll fade-in
        elementsToFadeIn.forEach(el => {
            el.classList.add('fade-in-hidden'); // Ensure initial hidden state
            observer.observe(el);
        });

        // Also observe blessing cards dynamically, as they can be added/removed.
        // The initial display will trigger this for initial blessings.
        new MutationObserver((mutationsList) => {
            for (const mutation of mutationsList) {
                if (mutation.type === 'childList') {
                    mutation.addedNodes.forEach(node => {
                        if (node.nodeType === 1 && node.classList.contains('blessing-card')) {
                            observer.observe(node);
                        }
                    });
                }
            }
        }).observe(blessingWall, { childList: true });


        // Initialize Firebase and Auth
        initializeFirebase();
      });
    })();
  </script>

</body>
</html>

